<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORACLE EYES - Your Divine Reading</title>

    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Noto+Serif+KR:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <style>
        * { margin:0; padding:0; box-sizing:border-box; }

        body {
            font-family: 'Noto Serif KR', serif;
            background: radial-gradient(circle at top, #0f1a2b, #000000 70%);
            color: #e8e8e8;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated Particles */
        .particle {
            position: fixed;
            font-size: 1.5rem;
            opacity: 0.15;
            pointer-events: none;
            animation: float 18s infinite ease-in-out;
            z-index: 0;
        }
        @keyframes float {
            0%{ transform:translate(0,0) rotate(0deg); opacity:0.1; }
            25%{ transform:translate(80px,-120px) rotate(90deg); opacity:0.25; }
            50%{ transform:translate(-40px,-220px) rotate(180deg); opacity:0.15; }
            75%{ transform:translate(-100px,-120px) rotate(270deg); opacity:0.25; }
            100%{ transform:translate(0,0) rotate(360deg); opacity:0.1; }
        }

        /* Container */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px 100px;
            position: relative;
            z-index: 2;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 50px;
            animation: fadeInDown 1.2s ease;
        }

        .oracle-symbol {
            font-size: 5rem;
            margin-bottom: 10px;
            display: block;
            animation: levitate 3s ease-in-out infinite;
            filter: drop-shadow(0 0 40px rgba(212,175,55,0.6));
        }

        @keyframes levitate {
            0%,100% { transform:translateY(0); }
            50% { transform:translateY(-15px); }
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            font-weight: 700;
            color: #d4af37;
            letter-spacing: 3px;
            text-shadow: 0 0 35px rgba(212,175,55,0.7);
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1rem;
            letter-spacing: 3px;
            color: #bbbbbb;
            text-transform: uppercase;
        }

        .divider {
            width: 150px;
            height: 2px;
            margin: 30px auto;
            background: linear-gradient(90deg, transparent, #d4af37, transparent);
        }

        /* ============================================
           LOADING SCREEN
           ============================================ */
        #loading {
            position: fixed;
            inset: 0;
            background: #000;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.8s ease;
        }

        .loading-symbol {
            font-size: 6rem;
            animation: spin 3s linear infinite;
            filter: drop-shadow(0 0 50px rgba(212,175,55,0.5));
            margin-bottom: 30px;
        }
        @keyframes spin { 100% { transform:rotate(360deg); } }

        .loading-text {
            font-size: 1.2rem;
            color: #d4af37;
            letter-spacing: 2px;
            animation: pulse 2s infinite;
        }
        @keyframes pulse { 50% { opacity: 0.5; } }

        /* ============================================
           COMPLETION EFFECT (Phase 1)
           ============================================ */
        #completionEffect {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9998;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.5s ease;
        }

        .completion-text {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            font-weight: 700;
            color: #d4af37;
            text-shadow: 0 0 50px rgba(212,175,55,0.8);
            margin-bottom: 20px;
            animation: scaleIn 0.8s ease;
        }

        @keyframes scaleIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .completion-subtitle {
            font-size: 1.2rem;
            color: #bbb;
            letter-spacing: 2px;
        }

        /* ============================================
           RESULT SECTION
           ============================================ */
        #result {
            display: none;
            animation: fadeIn 1s ease;
        }
        @keyframes fadeIn { 
            from { opacity:0; transform:translateY(20px); } 
            to { opacity:1; transform:translateY(0); } 
        }

        /* ============================================
           INTERACTIVE NAVIGATION (Sticky)
           ============================================ */
        .section-nav {
            position: sticky;
            top: 20px;
            background: rgba(20, 30, 48, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 50px;
            padding: 15px 20px;
            margin-bottom: 40px;
            display: flex;
            gap: 10px;
            overflow-x: auto;
            z-index: 10;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            opacity: 0;
            animation: slideDown 0.8s ease 1s forwards;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-nav::-webkit-scrollbar {
            height: 4px;
        }

        .section-nav::-webkit-scrollbar-thumb {
            background: #d4af37;
            border-radius: 2px;
        }

        .nav-item {
            padding: 8px 18px;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #bbb;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-size: 0.9rem;
        }

        .nav-item:hover {
            background: rgba(212, 175, 55, 0.2);
            border-color: #d4af37;
            color: #fff;
        }

        .nav-item.active {
            background: linear-gradient(135deg, #d4af37, #aa8a2e);
            border-color: #d4af37;
            color: #0a1929;
            font-weight: 600;
        }

        /* ============================================
           RESULT CARD
           ============================================ */
        .result-card {
            background: rgba(20, 30, 48, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 20px;
            padding: 50px 30px;
            margin-bottom: 40px;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.7);
        }

        /* Corner Decorations */
        .corner {
            position: absolute;
            width: 40px; height: 40px;
            border: 2px solid #d4af37;
            opacity: 0.5;
        }
        .corner.tl { top: 20px; left: 20px; border-right: none; border-bottom: none; }
        .corner.br { bottom: 20px; right: 20px; border-left: none; border-top: none; }

        /* ============================================
           MARKDOWN CONTENT STYLING
           ============================================ */
        .markdown-body {
            color: #e8e8e8;
            font-size: 1.1rem;
            line-height: 1.9;
            word-break: keep-all;
        }

        /* Section fade-in animation */
        .markdown-body h2 {
            opacity: 0;
            animation: sectionFadeIn 0.8s ease forwards;
        }

        @keyframes sectionFadeIn {
            from { 
                opacity: 0; 
                transform: translateX(-20px); 
            }
            to { 
                opacity: 1; 
                transform: translateX(0); 
            }
        }

        .markdown-body h1, .markdown-body h2 {
            font-family: 'Playfair Display', serif;
            color: #d4af37;
            margin-top: 40px;
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(212,175,55,0.2);
            padding-bottom: 10px;
            scroll-margin-top: 100px; /* For smooth scroll */
        }

        .markdown-body h2::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 24px;
            background: linear-gradient(180deg, #d4af37, transparent);
            margin-right: 12px;
            vertical-align: middle;
        }

        .markdown-body h3 {
            color: #fff;
            margin-top: 30px;
            font-size: 1.2rem;
        }

        .markdown-body strong {
            color: #ffd700;
            font-weight: 700;
        }

        .markdown-body p {
            margin-bottom: 1.5em;
            text-align: justify;
        }

        .markdown-body blockquote {
            border-left: 3px solid #d4af37;
            padding-left: 15px;
            margin: 20px 0;
            color: #ccc;
            font-style: italic;
            background: rgba(255,255,255,0.05);
            padding: 15px;
        }

        .markdown-body ul {
            padding-left: 20px;
            margin-bottom: 20px;
        }

        .markdown-body li {
            margin-bottom: 8px;
        }

        /* ============================================
           ACTION BUTTONS
           ============================================ */
        .action-bar {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
            animation: fadeIn 1s ease 1.5s backwards;
        }

        .btn {
            padding: 15px 30px;
            border-radius: 50px;
            font-family: 'Noto Serif KR', serif;
            font-weight: 600;
            cursor: pointer;
            border: none;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .btn-gold {
            background: linear-gradient(135deg, #d4af37, #aa8a2e);
            color: #0a1929;
            box-shadow: 0 10px 20px rgba(212,175,55,0.3);
        }
        .btn-gold:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 15px 30px rgba(212,175,55,0.5); 
        }

        .btn-dark {
            background: rgba(255,255,255,0.1);
            color: #fff;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .btn-dark:hover { 
            background: rgba(255,255,255,0.2); 
            transform: translateY(-3px); 
        }

        /* ============================================
           SCROLL PROGRESS
           ============================================ */
        .scroll-indicator {
            position: fixed; 
            top: 0; 
            left: 0; 
            height: 4px; 
            background: #d4af37; 
            z-index: 100; 
            width: 0%;
            box-shadow: 0 0 10px #d4af37;
            transition: width 0.1s ease;
        }

        /* ============================================
           TYPING CURSOR
           ============================================ */
        .typing-cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background: #d4af37;
            margin-left: 2px;
            animation: blink 1s infinite;
            vertical-align: text-bottom;
        }

        @keyframes blink {
            0%, 49% { opacity: 1; }
            50%, 100% { opacity: 0; }
        }

        /* ============================================
           RESPONSIVE
           ============================================ */
        @media (max-width: 600px) {
            .logo { font-size: 2.2rem; }
            .result-card { padding: 30px 20px; }
            .btn { flex: 1; justify-content: center; }
            .completion-text { font-size: 2.5rem; }
            .section-nav {
                justify-content: flex-start;
                padding: 12px 15px;
            }
            .nav-item {
                font-size: 0.85rem;
                padding: 6px 14px;
            }
        }
    </style>
</head>
<body>

    <div class="scroll-indicator" id="scrollProgress"></div>

    <div id="particles"></div>

    <!-- Loading Screen -->
    <div id="loading">
        <div class="loading-symbol">üîÆ</div>
        <div class="loading-text">THE STARS ARE ALIGNING...</div>
    </div>

    <!-- Completion Effect -->
    <div id="completionEffect">
        <div class="completion-text">‚ú® DESTINY UNLOCKED ‚ú®</div>
        <div class="completion-subtitle">Your 2026 fortune has been decoded</div>
    </div>

    <div class="container">
        <div class="header">
            <span class="oracle-symbol">üëÅÔ∏è</span>
            <h1 class="logo">ORACLE EYES</h1>
            <p class="subtitle">Your Cosmic Destiny Revealed</p>
            <div class="divider"></div>
        </div>

        <div id="result">
            <!-- Interactive Navigation -->
            <div class="section-nav" id="sectionNav">
                <!-- Dynamically generated -->
            </div>

            <div class="result-card" id="captureArea">
                <div class="corner tl"></div>
                <div class="corner br"></div>
                <div id="fortune-content" class="markdown-body"></div>
                
                <div style="text-align: center; margin-top: 50px; opacity: 0.5; font-size: 0.8rem;">
                    OracleEyes.AI ‚Ä¢ 2026 Premium Report
                </div>
            </div>

            <div class="action-bar">
                <button class="btn btn-dark" onclick="saveImage()">
                    <i class="fas fa-download"></i> Save
                </button>
                <button class="btn btn-dark" onclick="shareResult()">
                    <i class="fas fa-share-alt"></i> Share
                </button>
                <button class="btn btn-gold" onclick="location.href='index.html'">
                    <i class="fas fa-redo"></i> New Reading
                </button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // 1. PARTICLES
        // ============================================
        const particlesContainer = document.getElementById('particles');
        const shapes = ['‚ú®', '‚≠ê', 'üåô', 'üîÆ'];
        for(let i=0; i<20; i++) {
            const p = document.createElement('div');
            p.className = 'particle';
            p.textContent = shapes[Math.floor(Math.random()*shapes.length)];
            p.style.left = Math.random()*100 + '%';
            p.style.top = Math.random()*100 + '%';
            p.style.animationDelay = Math.random()*5 + 's';
            p.style.animationDuration = (15 + Math.random()*10) + 's';
            particlesContainer.appendChild(p);
        }

        // ============================================
        // 2. SCROLL PROGRESS BAR
        // ============================================
        window.addEventListener('scroll', () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById("scrollProgress").style.width = scrolled + "%";
        });

        // ============================================
        // 3. MAIN SCRIPT
        // ============================================
        const fortuneData = sessionStorage.getItem('fortuneData');
        const loading = document.getElementById('loading');
        const completionEffect = document.getElementById('completionEffect');
        const resultDiv = document.getElementById('result');
        const contentDiv = document.getElementById('fortune-content');

        if (fortuneData) {
            const rawText = JSON.parse(fortuneData);
            
            // Convert markdown to HTML
            const htmlContent = marked.parse(rawText);
            
            // Phase 1: Show completion effect (2Ï¥à)
            setTimeout(() => {
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    completionEffect.style.display = 'flex';
                    fireConfetti(); // Ìè≠Ï£Ω
                }, 800);
            }, 1500);

            // Phase 2: Hide completion, show result with typing (3.5Ï¥à)
            setTimeout(() => {
                completionEffect.style.opacity = '0';
                setTimeout(() => {
                    completionEffect.style.display = 'none';
                    resultDiv.style.display = 'block';
                    
                    // Start typing animation
                    typeContent(htmlContent);
                }, 800);
            }, 3500);
            
            // Clear session storage
            sessionStorage.removeItem('fortuneData');
        } else {
            location.href = 'index.html';
        }

        // ============================================
        // 4. TYPING ANIMATION
        // ============================================
        function typeContent(htmlContent) {
            // Create a temporary element to parse HTML
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = htmlContent;
            
            // Insert content immediately (for structure)
            contentDiv.innerHTML = htmlContent;
            
            // Build section navigation
            buildSectionNav();
            
            // Animate sections sequentially
            const sections = contentDiv.querySelectorAll('h2');
            sections.forEach((section, index) => {
                setTimeout(() => {
                    section.style.animationDelay = '0s';
                    section.style.opacity = '1';
                    
                    // Scroll hint on first section
                    if (index === 0) {
                        section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }, index * 300); // Stagger by 300ms
            });
        }

        // ============================================
        // 5. SECTION NAVIGATION
        // ============================================
        function buildSectionNav() {
            const nav = document.getElementById('sectionNav');
            const sections = contentDiv.querySelectorAll('h2');
            
            sections.forEach((section, index) => {
                const navItem = document.createElement('div');
                navItem.className = 'nav-item';
                navItem.textContent = section.textContent.replace(/[üîÆüí∞‚ù§Ô∏èüíºüí™üóìÔ∏èüéÅ‚ú®‚ö°üåüüßø]/g, '').trim();
                
                // Add emoji
                const emoji = section.textContent.match(/[üîÆüí∞‚ù§Ô∏èüíºüí™üóìÔ∏èüéÅ‚ú®‚ö°üåüüßø]/);
                if (emoji) {
                    navItem.textContent = emoji[0] + ' ' + navItem.textContent;
                }
                
                navItem.onclick = () => {
                    section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    
                    // Update active state
                    document.querySelectorAll('.nav-item').forEach(item => 
                        item.classList.remove('active'));
                    navItem.classList.add('active');
                };
                
                // Set first as active
                if (index === 0) navItem.classList.add('active');
                
                nav.appendChild(navItem);
            });
        }

        // ============================================
        // 6. CONFETTI EFFECT
        // ============================================
        function fireConfetti() {
            const duration = 3000;
            const end = Date.now() + duration;
            
            (function frame() {
                confetti({
                    particleCount: 5,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: ['#FFD700', '#FFFFFF', '#d4af37']
                });
                confetti({
                    particleCount: 5,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: ['#FFD700', '#FFFFFF', '#d4af37']
                });
                
                if (Date.now() < end) {
                    requestAnimationFrame(frame);
                }
            }());
        }

        // ============================================
        // 7. SAVE IMAGE
        // ============================================
        function saveImage() {
            const element = document.getElementById('captureArea');
            html2canvas(element, {
                backgroundColor: '#0f1a2b',
                scale: 2,
                logging: false
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'My_Destiny_2026_OracleEyes.png';
                link.href = canvas.toDataURL();
                link.click();
                
                // Show success message
                showToast('üì∏ Image saved successfully!');
            });
        }

        // ============================================
        // 8. SHARE RESULT
        // ============================================
        function shareResult() {
            if (navigator.share) {
                navigator.share({
                    title: 'OracleEyes - My 2026 Destiny',
                    text: 'I just revealed my 2026 destiny with OracleEyes AI! ‚ú®',
                    url: window.location.origin
                }).then(() => {
                    showToast('üéâ Shared successfully!');
                });
            } else {
                // Fallback: copy link
                navigator.clipboard.writeText(window.location.origin);
                showToast('üîó Link copied to clipboard!');
            }
        }

        // ============================================
        // 9. TOAST NOTIFICATION
        // ============================================
        function showToast(message) {
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                bottom: 30px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(212, 175, 55, 0.95);
                color: #0a1929;
                padding: 15px 30px;
                border-radius: 50px;
                font-weight: 600;
                z-index: 10000;
                animation: slideUp 0.5s ease;
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transition = 'opacity 0.5s';
                setTimeout(() => toast.remove(), 500);
            }, 2500);
        }

        // Add slideUp animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideUp {
                from { opacity: 0; transform: translate(-50%, 20px); }
                to { opacity: 1; transform: translate(-50%, 0); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
